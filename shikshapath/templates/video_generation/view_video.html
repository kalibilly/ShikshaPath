{% extends "base.html" %}
{% load static %}

{% block title %}{{ video.source_content|truncatewords:3 }} - Video{% endblock %}

{% block content %}
<div class="container mt-5">
    <div class="row">
        <div class="col-md-10 mx-auto">
            <a href="{% url 'videos:list_videos' video.course.id %}" class="btn btn-secondary btn-sm mb-3">
                <i class="fas fa-arrow-left"></i> Back to Videos
            </a>
            
            <div class="card">
                <div class="card-body">
                    <h3 class="card-title">{{ video.source_content|truncatewords:10 }}</h3>
                    <p class="card-text text-muted">
                        Course: <strong>{{ video.course.title }}</strong><br>
                        Instructor: <strong>{{ video.instructor.get_full_name }}</strong>
                    </p>
                </div>
            </div>
            
            <div class="mt-4">
                {% if video.generated_video %}
                    <div class="video-container mb-4">
                        <video width="100%" height="auto" controls style="border: 1px solid #ddd; border-radius: 5px;">
                            <source src="{{ video.generated_video.url }}" type="video/mp4">
                            Your browser does not support the video tag.
                        </video>
                    </div>
                {% else %}
                    <div class="alert alert-warning">
                        Video file not available
                    </div>
                {% endif %}
                
                <div class="card">
                    <div class="card-header">
                        <h5 class="mb-0">Video Information</h5>
                    </div>
                    <div class="card-body">
                        <div class="row">
                            <div class="col-md-6">
                                <p><strong>Animation Style:</strong> {{ video.get_animation_style_display }}</p>
                                <p><strong>Duration:</strong> {{ video.duration }} seconds</p>
                                <p><strong>Quality:</strong> 
                                    {% if video.quality == 'low' %}
                                        480p
                                    {% elif video.quality == 'medium' %}
                                        720p
                                    {% else %}
                                        1080p
                                    {% endif %}
                                </p>
                            </div>
                            <div class="col-md-6">
                                <p><strong>Status:</strong> 
                                    {% if video.status == 'completed' %}
                                        <span class="badge bg-success">Completed</span>
                                    {% elif video.status == 'processing' %}
                                        <span class="badge bg-warning">Processing</span>
                                    {% elif video.status == 'pending' %}
                                        <span class="badge bg-secondary">Pending</span>
                                    {% elif video.status == 'failed' %}
                                        <span class="badge bg-danger">Failed</span>
                                    {% endif %}
                                </p>
                                <p><strong>Generated:</strong> {{ video.created_at|date:"M d, Y H:i" }}</p>
                                {% if video.completed_at %}
                                    <p><strong>Completed:</strong> {{ video.completed_at|date:"M d, Y H:i" }}</p>
                                {% endif %}
                            </div>
                        </div>
                        
                        {% if video.error_message %}
                            <div class="alert alert-danger mt-3">
                                <strong>Error:</strong> {{ video.error_message }}
                            </div>
                        {% endif %}
                    </div>
                </div>
            </div>
            
            <div class="mt-4">
                <div class="card">
                    <div class="card-header">
                        <h5 class="mb-0">Source Content</h5>
                    </div>
                    <div class="card-body">
                        <p>{{ video.source_content|linebreaks }}</p>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<style>
    .video-container {
        background-color: #000;
        padding: 10px;
        border-radius: 5px;
    }
</style>
{% endblock %}
